
%
%  $Description: Author guidelines and sample document in LaTeX 2.09$ 
%
%  $Author: ienne $
%  $Date: 1995/09/15 15:20:59 $
%  $Revision: 1.4 $
%

\documentclass[times, 10pt,twocolumn]{article} 
\usepackage{latex8}
\usepackage{times}


% Users' option
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{color}

\newif\ifdraft
\drafttrue

\ifdraft
\newcommand{\fixme}[1]{ { \bf{ ***FIXME: #1 }} }
\newcommand{\jhanote}[1]{ {\textcolor{red} { ***Jha: #1 }}}
\newcommand{\Nkimnote}[1]{ {\textcolor{green} { ***Nkim: #1 }}}
\newcommand{\skonote}[1]{ {\textcolor{blue} { ***Jeff: #1 }}}
\newcommand{\Jkimnote}[1]{ {\textcolor{purple} { ***Jkim: #1 }}}
\else
\newcommand{\jhanote}[1]{}
\newcommand{\Nkimnote}[1]{}
\newcommand{\fixme}[1]{}
\newcommand{\skonote}[1]{}
\newcommand{\Jkimnote}[1]{}
\fi
% End of users' option


%\documentstyle[times,art10,twocolumn,latex8]{article}

%------------------------------------------------------------------------- 
% take the % away on next line to produce the final camera-ready version 
\pagestyle{empty}




%------------------------------------------------------------------------- 
\begin{document}

\title{Efficient Runtime Environment for Coupled Multi-Physics Simulations: Dynamic Resource Allocation and Load-Balancing}

\author{Soon-Heum Ko, Nayong Kim, Joohyun Kim, Abhinav Thota, Shantenu Jha\\
Center for Computation and Technology\\
Louisiana State University, Baton Rouge, LA 70803, USA\\
(sko,nykim,jhkim,athota1,sjha)@cct.lsu.edu\\
% For a paper whose authors are all at the same institution, 
% omit the following lines up until the closing ``}''.
% Additional authors and addresses can be added with ``\and'', 
% just like the second author.
%\and
% Dimitris Nikitopoulos\\
% Mechanical Engineering Department\\
% Louisiana State University, Baton Rouge, LA 70803, USA\\
% meniki@lsu.edu\\
\and
Yaakoub El Khamra\\
Texas Advanced Computing Center\\
The University of Texas at Austin, Austin, Texas 78758, USA\\
yye00@austin.mail.address\\
}


\maketitle
\thispagestyle{empty}

\begin{abstract}
  Coupled Multi-Physics simulations, such as hybrid CFD-MD simulations, represent an increasingly important class of applications.  Often the physical problems of interest demand the use of high-end computers, such as TeraGrid resources, which are often accessible only via batch-queues.  We develop and demonstrate a novel approach to overcoming the co-scheduling requirements associated with coupled runs.  Our solution which is developed using SAGA and a SAGA-based framework (BigJob), is a generalization of the Pilot-Job concept -- which in of itself is not new, but is applied to coupled simulations for the first time.  Our solution not only overcomes the initial co-scheduling problem, but provides a dynamic resource allocation mechanism. Such support for dynamic resources is critical for a load-balancing mechanism, which we develop and demonstrate to be effective at reducing the total time-to-solution of the problem.  We also demonstrate for the first time that we are aware of, the use of multiple Pilot-Job mechanisms to solve the same problem; specifically, we use SAGA to access the SAGA-based Pilot-Job on high-end (TeraGrid) resources whilst using the native Condor Pilot-Job (Glide-in) on Condor resources, and importantly both are accessed via the same interface. 
\end{abstract}

\skonote{Also, does anybody know how to document authors list in IEEE format? I'm not so sure whether above format is right.}\\

%------------------------------------------------------------------------- 
\Section{Introduction} 

Multi-Physics simulation techniques are being increasingly used to study many different physical phenomenon spanning time and length scales at different level of details\jhanote{need a couple of references to multi-physics simulations here}. These techniques have been used to investigate phenomenon from crack-propagation in materials, biological systems as well as understanding multi-phase fluid flow in constrained geometry.

In addition to the ``physics challenges'' of these Multi-Physics coupled simulations, there exist interesting ``computational challenges''.  Probably the best known (and investigated) is the challenge of simulating large and complex systems, leading to simulations that require greater computational resources -- often involving HPC resources, and no longer working on dedicated PCs. Parallelization helps address the individual codes, but incorporating two distinct codes under the umbrella of a single tightly-coupled application (say using MPI) is not without significant problems.  \jhanote{Introduce the fact that we will focus on Coupled Independent codes}. 

Here we will focus on the challenges arising from running tightly-coupled simulations on production systems with batch-queues -- and thus it cannot be guaranteed that two separate jobs will execute concurrently. Specifically we will consider the case of coupling a Computational Fluid Dynamics (CFD) code and a Molecular Dynamics (MD) code, whereby the communication is via the exchange of files and not Unix pipes (see next section for details on the coupling).  Although not exactly tightly-coupled in the sense of MPI, i.e., very frequent and extreme sensitivty to latency in communication delay, the CFD and MD codes have frequent communications, (e.g., the CFD code conducts data exchange in every iteration) they need to run concurrently.  Thus, without explicit support for co-scheduling, it is unlikely that coupled CFD-MD simulations will run concurrently as inevitably the first job to run will have to wait for the other to follow.
% Users' account loss is inevitable in conventional queuing systems except when sufficient CPUs are idling, 
And even in cases where they can run concurrently, without explicit load-management/balancing support, there is likely to be inefficient utilization of compute resources due to load imbalance.  As the performance of each tool changes with computing resource and problem size, re-adjustment of allocated resources to each task according to their performance is required during the simulation. However, if the simulation have been submitted as independent jobs, changing CPU allocation to address these change is challenging. Thus, the best way in conventional job submission system would be to find a site with sufficient resource pool and submit two jobs with optimal number of processors according to the pre-test data on performance of each tool in that facility with the same problem size.

Another important challenge, especially for large-scale simulations is the need for efficient load-balancing, taking into account the individual simulation performance.  Interestingly, as we will show, effective load-balancing of two independent but concurrently running codes introduces the need for dynamic resource allocation, and the same solution that we devise to overcome the co-scheduling requirement/constraint of concurrent jobs support the feature of dynamic resource allocation.  But given the lack of System or Service-level support to address the challenges outlined above, there is a need to address the solution at the user (application) level. This paper aims to provide novel solutions to the above problem....

Here we outline our approach -- which is not-tied to a specific application set, is scalable and extensible. SAGA (the Simple API for Grid Applications)~\cite{Jha:2008} is a high-level API which provides the basic functionality required to implement distributed applications in an infrastructure and middleware independent fashion.  SAGA enables the creation of higher-levels of abstractions, for example a contain-job and pilot-job, which is referred to as the BigJob abstraction~\cite{Jha:2009}.  -- which denotes a container task where a number of subtasks can run in pre-defined schedule with specified number of processors whether or not they are coupled.  Although the Container-Job/Pilot-Job concept is not novel {\it per se}, we believe this is the first documented utilization of these abstractions to perform coupled Multi-Physics simulations. Additionally, our approach employing a SAGA-based Pilot-Job is infrastructure neutral, unlike most other Pilot-Jobs.  The essential improvement of BigJob abstraction in this application lies in removing the need for scheduling the two-components separately and in providing a single job-requirement to the queuing system. Additional efficiency is provided via application scenario specific load balancing modules. But in order to work efficiently, load-balancing algorithms require dynamic resource allocation...

%------------------------------------------------------------------------- 
\Section{Hybrid CFD/MD Approach and Computer Scientific Requirement}
\skonote{(Nayong)}

\skonote{Motivation of hybrid CFD/MD simulation (Nayong, 2 paragraphs)
Brief description of flow regimes for conventional CFD and MD approaches and their limitation (1 paragraph), the benefit of coupled simulation (1 paragraph)}

\skonote{Coupling algorithm (1 or 2 paragraphs)
: How the coupling is accomplished (with 1 figure of layer composition), mention that 'file-based approach is used' / The role of each layer and meaning of constrained MD equation / Solution (1 figure)}

\skonote{Baseline CFD and MD codes (1 paragraph): Schemes within CFD code, LAMMPS code / Comment that 'other CFD or MD components can be attachable/replaceable if interface is properly given'}

\skonote{Requirements for efficient computation (1 paragraph)
: Two simulations should start concurrently / Two codes should be load-balanced between communications, for synchronous and frequent communication / More resources required for MD part; Include the definition of total simulation time (as the sum of startup time, wait time and runtime) and specify which part we are going to reduce}

\skonote{Brief introduction of BigJob concept (1 paragraph)
: Just mention that 'BigJob abstraction will satisfy the above requirements'}

 A hybrid CFD/MD approach~\cite{Nie:2004},~\cite{Yen:2007} is a simulation method which adopts the continuum hypothesis in capturing the macroscopic features of a flow-field and resolves intermolecular effects on interfaces of different materials. CFD (Computational Fluid Dynamics) can accurately predict flow properties on conventional moderate/large size fluid domains, but is intrinsically impossible to reflect the characteristics of surrounding solid materials. MD (Molecular Dynamics) guarantees more accurate solution in that it also considers collision between fluid particles as well as interaction with solid particles, while its huge amount of computation time makes this method hard to solve a large scale system. An important challenge is solving a flowfield where viscous effect of solid boundary is dominant and the scale is sufficiently large in view of particle dynamics. These fluid systems can only be analyzed by solving particle interaction near the wall through molecular dynamics and applying a continuum approach on far field region. As is seen in Figure 1, the hybrid approach accurately describes strong interaction between solid elements and fluid particles near the wall and conducts efficient simulation in the far field follows the continuum approach.

We have developed an {\it in-house} incompressible CFD code~\cite{Lee:2006} and and employed the in-house modified version of LAMMPS~\cite{LAMMPS} for MD. We will report on the details of the communication mechanism employed elsewhere, but
we briefly present the high-level details here:

%------------------------------------------------------------------------- 
\Section{SAGA and Its Abstraction for Large-scale Computation}
\skonote{(Shantenu and Joohyun)}

- Introduction of SAGA (Shantenu, 1 paragraph)
: What is SAGA, which routines/functions are available and useful for this coupled simulation

- Introduction of PilotJob and BigJob (Joohyun, 1 or 2 paragraphs)
: What is PilotJob, BigJob / what have been done so far and how effective it was when using BigJob

- Structure and Simulation Flow of BigJob Abstraction for Coupled Simulation (Joohyun, 1 or 2 paragraphs)
: Structure of BigJob with new components (Hybrid job manager - python script / load balancing routine), how the simulation is performed


%------------------------------------------------------------------------- 
\Section{Load Balancing for Performance Enhancement of Coupled Multi-physical Simulation}
\skonote{(Soon-Heum)}

- Motivation

- Equation and Implementation

- Test Result (Compared with 1 BigJob with fixed PEs in each sub-task)

- Limitation
: It checks the performance of code and only applies iteratively. Considers application codes have good scalability (the more, the better)


%------------------------------------------------------------------------- 
\Section{Three Use Cases of Hybrid CFD/MD Simulation using SAGA and SAGA-based Framework}
\skonote{(Soon-Heum, Joohyun and Abhinav)}

- Objectives of Each BigJob Test (Soon-Heum, 1 paragraph)
: What do three testsuites focus on

- Implementation and Test Result of 1 BigJob (Soon-Heum, 1 paragraph)
: How it is implemented (without load balancing), what's the focus and what is the total time for coupled simulation (compare with the same test when CFD and MD jobs are separately applied to the queueing system)

- Implementation and Test Result of 2 BigJobs (Joohyun and Abhinav, 1 paragraph)
: How it is implemented, what's the focus and what is the total time for coupled simulation (compare with the 1 BigJob: 1 BigJob with 64 PEs VS 2 BigJobs with 32 PEs each)

- Implementation and Test Result of 2 BigJobs on Heterogeneous Machines (Joohyun and Abhinav, 1 paragraph)
: How it is implemented, what's the focus and what is the total time for coupled simulation (compare with the 2 BigJobs in the Same Machine: Different (more) resource requirement in this case) 


%------------------------------------------------------------------------- 
\Section{Test on Condor Queueing System}
\skonote{(Yaakoub and Shantenu)}\\
\skonote{I have no idea on this chapter :)}


\Section{Conclusions}

Please direct any questions to the production editor in charge of these 
proceedings at the IEEE Computer Society Press: Phone (714) 821-8380, or 
Fax (714) 761-1784.

\section*{Acknowledgement}
This work is part of the Cybertools (http://cybertools.loni.org) project. Important funding for SAGA has been provided by the UK EPSRC grant number GR/D0766171/1 (via OMII).  This work has also been made possible thanks to computer resources provided by LONI.  We thank Andre Luckow for some initial work on BigJob, Lukasz Lacinski for help with SAGA deployment and Joao Abecasis for his work on the SAGA Condor adaptors.

%------------------------------------------------------------------------- 
\nocite{ex1,ex2}
\bibliographystyle{latex8}
\bibliography{saga_tg08}

\end{document}




%------------------------------------------------------------------------- 
\Section{Instructions}

Please read the following carefully.

%------------------------------------------------------------------------- 
\SubSection{Language}

All manuscripts must be in English.

%------------------------------------------------------------------------- 
\SubSection{Printing your paper}

Print your properly formatted text on high-quality, $8.5times 11$-inch 
white printer paper. A4 paper is also acceptable, but please leave the 
extra 0.5 inch (1.27 cm) at the BOTTOM of the page.

%------------------------------------------------------------------------- 
\SubSection{Margins and page numbering}

All printed material, including text, illustrations, and charts, must be 
kept within a print area 6-7/8 inches (17.5 cm) wide by 8-7/8 inches 
(22.54 cm) high. Do not write or print anything outside the print area. 
Number your pages lightly, in pencil, on the upper right-hand corners of 
the BACKS of the pages (for example, 1/10, 2/10, or 1 of 10, 2 of 10, and 
so forth). Please do not write on the fronts of the pages, nor on the 
lower halves of the backs of the pages.


%------------------------------------------------------------------------ 
\SubSection{Formatting your paper}

All text must be in a two-column format. The total allowable width of 
the text area is 6-7/8 inches (17.5 cm) wide by 8-7/8 inches (22.54 cm) 
high. Columns are to be 3-1/4 inches (8.25 cm) wide, with a 5/16 inch 
(0.8 cm) space between them. The main title (on the first page) should 
begin 1.0 inch (2.54 cm) from the top edge of the page. The second and 
following pages should begin 1.0 inch (2.54 cm) from the top edge. On 
all pages, the bottom margin should be 1-1/8 inches (2.86 cm) from the 
bottom edge of the page for $8.5 \times 11$-inch paper; for A4 paper, 
approximately 1-5/8 inches (4.13 cm) from the bottom edge of the page.

%------------------------------------------------------------------------- 
\SubSection{Type-style and fonts}

Wherever Times is specified, Times Roman may also be used. If neither is 
available on your word processor, please use the font closest in 
appearance to Times that you have access to.

MAIN TITLE. Center the title 1-3/8 inches (3.49 cm) from the top edge of 
the first page. The title should be in Times 14-point, boldface type. 
Capitalize the first letter of nouns, pronouns, verbs, adjectives, and 
adverbs; do not capitalize articles, coordinate conjunctions, or 
prepositions (unless the title begins with such a word). Leave two blank 
lines after the title.

AUTHOR NAME(s) and AFFILIATION(s) are to be centered beneath the title 
and printed in Times 12-point, non-boldface type. This information is to 
be followed by two blank lines.

The ABSTRACT and MAIN TEXT are to be in a two-column format. 

MAIN TEXT. Type main text in 10-point Times, single-spaced. Do NOT use 
double-spacing. All paragraphs should be indented 1 pica (approx. 1/6 
inch or 0.422 cm). Make sure your text is fully justified---that is, 
flush left and flush right. Please do not place any additional blank 
lines between paragraphs. Figure and table captions should be 10-point 
Helvetica boldface type as in
\begin{figure}[h]
   \caption{Example of caption.}
\end{figure}

\noindent Long captions should be set as in 
\begin{figure}[h] 
   \caption{Example of long caption requiring more than one line. It is 
     not typed centered but aligned on both sides and indented with an 
     additional margin on both sides of 1~pica.}
\end{figure}

\noindent Callouts should be 9-point Helvetica, non-boldface type. 
Initially capitalize only the first word of section titles and first-, 
second-, and third-order headings.

FIRST-ORDER HEADINGS. (For example, {\large \bf 1. Introduction}) 
should be Times 12-point boldface, initially capitalized, flush left, 
with one blank line before, and one blank line after.

SECOND-ORDER HEADINGS. (For example, {\elvbf 1.1. Database elements}) 
should be Times 11-point boldface, initially capitalized, flush left, 
with one blank line before, and one after. If you require a third-order 
heading (we discourage it), use 10-point Times, boldface, initially 
capitalized, flush left, preceded by one blank line, followed by a period 
and your text on the same line.

%------------------------------------------------------------------------- 
\SubSection{Footnotes}

Please use footnotes sparingly%
\footnote
   {%
     Or, better still, try to avoid footnotes altogether.  To help your 
     readers, avoid using footnotes altogether and include necessary 
     peripheral observations in the text (within parentheses, if you 
     prefer, as in this sentence).
   }
and place them at the bottom of the column on the page on which they are 
referenced. Use Times 8-point type, single-spaced.


%------------------------------------------------------------------------- 
\SubSection{References}

List and number all bibliographical references in 9-point Times, 
single-spaced, at the end of your paper. When referenced in the text, 
enclose the citation number in square brackets, for example~\cite{ex1}. 
Where appropriate, include the name(s) of editors of referenced books.

%------------------------------------------------------------------------- 
\SubSection{Illustrations, graphs, and photographs}

All graphics should be centered. Your artwork must be in place in the 
article (preferably printed as part of the text rather than pasted up). 
If you are using photographs and are able to have halftones made at a 
print shop, use a 100- or 110-line screen. If you must use plain photos, 
they must be pasted onto your manuscript. Use rubber cement to affix the 
images in place. Black and white, clear, glossy-finish photos are 
preferable to color. Supply the best quality photographs and 
illustrations possible. Penciled lines and very fine lines do not 
reproduce well. Remember, the quality of the book cannot be better than 
the originals provided. Do NOT use tape on your pages!

%------------------------------------------------------------------------- 
\SubSection{Color}

The use of color on interior pages (that is, pages other
than the cover) is prohibitively expensive. We publish interior pages in 
color only when it is specifically requested and budgeted for by the 
conference organizers. DO NOT SUBMIT COLOR IMAGES IN YOUR 
PAPERS UNLESS SPECIFICALLY INSTRUCTED TO DO SO.

%------------------------------------------------------------------------- 
\SubSection{Symbols}

If your word processor or typewriter cannot produce Greek letters, 
mathematical symbols, or other graphical elements, please use 
pressure-sensitive (self-adhesive) rub-on symbols or letters (available 
in most stationery stores, art stores, or graphics shops).

%------------------------------------------------------------------------ 
\SubSection{Copyright forms}

You must include your signed IEEE copyright release form when you submit 
your finished paper. We MUST have this form before your paper can be 
published in the proceedings.
